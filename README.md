# Тестовое задание

## Задание 1
Заказчик утверждает, что продажи с НДС по сети, по группе товаров 'Биологически активныедобавки', в июне 2017 составил 1 782 949.1 руб. Продажи шт. - 6761.10.
Необходимо найти и устранить возможные причины расхождений.

- Объём продаж: `6761.10` штук  
- Сумма продаж с НДС: `1 782 949.10` рублей

Задача: найти причину расхождения с результатом ETL-процедуры.

---

## Ключевой вывод

Исходная процедура использовала поле `sale_net`, что дало заниженные результаты.  
После замены на `sale_grs` и правильного фильтра — результат совпал с цифрами заказчика.

---

## Финальный запрос

```sql
SELECT 
    SUM(sale_grs) AS [Продажи руб., с НДС],
    SUM(quantity) AS [Объём продаж, шт.]
FROM fct_cheque 
WHERE date_id BETWEEN 20170601 AND 20170630 
  AND good_id IN (
    SELECT good_id 
    FROM dim_goods 
    WHERE group_name = 'Биологически активные добавки'
);
```

✅ Этот запрос вернул:
- `6761.10` штук
- `1 782 949.10` руб. с НДС

---
