# Тестовое задание

## Задание 1
Заказчик утверждает, что продажи с НДС по сети, по группе товаров 'Биологически активныедобавки', в июне 2017 составил 1 782 949.1 руб. Продажи шт. - 6761.10.
Необходимо найти и устранить возможные причины расхождений.

- Объём продаж: `6761.10` штук  
- Сумма продаж с НДС: `1 782 949.10` рублей

Задача: найти причину расхождения с результатом ETL-процедуры.

---

## Анализ

Были выявлены следующие проблемы:

- В `dim_goods` найдены дубликаты по `good_id`: `245427`, `102018`, `1553`
- В `dim_cash_register` дубликат по `cash_register_id = 7`
- В `dim_stores` отсутствовал `store_id = 47`, хотя он использовался в `fct_cheque`
- Некоторые строки из фактов не находили соответствий в справочниках при `JOIN`
- Важно использовать `sale_grs`, а не `sale_net`, если речь про сумму **с НДС**

---

## Исправления

- Удалены дубликаты из `dim_goods` и `dim_cash_register`
- Добавлена отсутствующая аптека из `fct_cheque` в `dim_stores`
- После этого расчёт проводится через `JOIN` корректно

---
```
Исправленный запрос вернул:
- `6761.10` штук
- `1 782 949.10` руб. с НДС
```
---
