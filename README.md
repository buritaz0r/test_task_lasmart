# –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ

## –ó–∞–¥–∞–Ω–∏–µ 1
–ó–∞–∫–∞–∑—á–∏–∫ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ–¥–∞–∂–∏ —Å –ù–î–° –ø–æ —Å–µ—Ç–∏, –ø–æ –≥—Ä—É–ø–ø–µ —Ç–æ–≤–∞—Ä–æ–≤ '–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ–¥–æ–±–∞–≤–∫–∏', –≤ –∏—é–Ω–µ 2017 —Å–æ—Å—Ç–∞–≤–∏–ª 1 782 949.1 —Ä—É–±. –ü—Ä–æ–¥–∞–∂–∏ —à—Ç. - 6761.10.
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π.

- –û–±—ä—ë–º –ø—Ä–æ–¥–∞–∂: `6761.10` —à—Ç—É–∫  
- –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ —Å –ù–î–°: `1 782 949.10` —Ä—É–±–ª–µ–π

–ó–∞–¥–∞—á–∞: –Ω–∞–π—Ç–∏ –ø—Ä–∏—á–∏–Ω—É —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º ETL-–ø—Ä–æ—Ü–µ–¥—É—Ä—ã.

---

## –ö–ª—é—á–µ–≤–æ–π –≤—ã–≤–æ–¥

–ò—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –ø–æ–ª–µ `sale_net`, —á—Ç–æ –¥–∞–ª–æ –∑–∞–Ω–∏–∂–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.  
–ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã –Ω–∞ `sale_grs` –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–≤–ø–∞–ª —Å —Ü–∏—Ñ—Ä–∞–º–∏ –∑–∞–∫–∞–∑—á–∏–∫–∞.

---

## –§–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å

```sql
SELECT 
    SUM(sale_grs) AS [–ü—Ä–æ–¥–∞–∂–∏ —Ä—É–±., —Å –ù–î–°],
    SUM(quantity) AS [–û–±—ä—ë–º –ø—Ä–æ–¥–∞–∂, —à—Ç.]
FROM fct_cheque 
WHERE date_id BETWEEN 20170601 AND 20170630 
  AND good_id IN (
    SELECT good_id 
    FROM dim_goods 
    WHERE group_name = '–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–æ–±–∞–≤–∫–∏'
);
```

‚úÖ –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω—É–ª:
- `6761.10` —à—Ç—É–∫
- `1 782 949.10` —Ä—É–±. —Å –ù–î–°

---

## –í—ã–≤–æ–¥

- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è `JOIN` –Ω–∞ `dim_stores` –∏–ª–∏ `dim_cash_register`
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `dim_goods`
- –í–∞–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sale_grs`, –∞ –Ω–µ `sale_net`, –µ—Å–ª–∏ —Ä–µ—á—å –ø—Ä–æ —Å—É–º–º—É **—Å –ù–î–°**

---

## –ü–ª–∞–Ω –Ω–∞ –±—É–¥—É—â–µ–µ

–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ:
- —Å—Ä–µ–¥–Ω–µ–π –∑–∞–∫—É–ø–æ—á–Ω–æ–π —Ü–µ–Ω—ã
- —Ä–∞—Å—á—ë—Ç–∞ –º–∞—Ä–∂–∏
- –Ω–∞—Ü–µ–Ω–∫–∏ %

üß© –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –∏ SQL ‚Äî –≤ –ø–∞–ø–∫–µ `/sql`
